import{c as N,w as W,r as v,ar as x,ag as Y,as as P,at as O,au as I,av as F,M as m,aw as _,ax as X,I as B,y as L,ay as q,az as H,aA as K,aB as z}from"./index-L6wp4BQo.js";const[ne,re]=N({hookName:"useFieldContext",providerName:"<FieldProvider />",strict:!1}),se=e=>W()(e,["immediate","lazyMount","onExitComplete","present","unmountOnExit"]);function U(e){const t={each(n){for(let r=0;r<e.frames?.length;r+=1){const i=e.frames[r];i&&n(i)}},queueBeforeEvent(n,r){const i=new Set;return t.each(s=>{try{i.add(_(s.document,n,r))}catch{}}),()=>{try{i.forEach(s=>s())}catch{}}},addEventListener(n,r,i){return t.each(s=>{try{s.document.addEventListener(n,r,i)}catch{}}),()=>{try{t.removeEventListener(n,r,i)}catch{}}},removeEventListener(n,r,i){t.each(s=>{try{s.document.removeEventListener(n,r,i)}catch{}})}};return t}var D="pointerdown.outside",S="focus.outside";function R(e){for(const t of e)if(B(t)&&F(t))return!0;return!1}var M=e=>"clientY"in e;function V(e,t){if(!M(t)||!e)return!1;const n=e.getBoundingClientRect();return n.width===0||n.height===0?!1:n.top<=t.clientY&&t.clientY<=n.top+n.height&&n.left<=t.clientX&&t.clientX<=n.left+n.width}function j(e){const t=m(e);if(!t||!M(e))return!1;const r=t.scrollHeight>t.clientHeight&&e.clientX>t.clientWidth,s=t.scrollWidth>t.clientWidth&&e.clientY>t.clientHeight;return r||s}function $(e,t){const{exclude:n,onFocusOutside:r,onPointerDownOutside:i,onInteractOutside:s,defer:p}=t;if(!e)return;const h=x(e),k=Y(e),y=U(k);function g(a){const u=m(a);return!B(u)||L(e,u)||V(e,a)||j(a)?!1:!n?.(u)}const f=new Set;function o(a){function u(){const d=p?v:w=>w(),A=a.composedPath?.()??[a.target];d(()=>{if(!(!e||!g(a))){if(i||s){const w=O(i,s);e.addEventListener(D,w,{once:!0})}I(e,D,{bubbles:!1,cancelable:!0,detail:{originalEvent:a,contextmenu:X(a),focusable:R(A)}})}})}a.pointerType==="touch"?(f.forEach(d=>d()),f.add(P(h,"click",u,{once:!0})),f.add(y.addEventListener("click",u,{once:!0}))):u()}const c=new Set,b=setTimeout(()=>{c.add(y.addEventListener("pointerdown",o,!0)),c.add(P(h,"pointerdown",o,!0))},0);function E(a){(p?v:d=>d())(()=>{if(!(!e||!g(a))){if(r||s){const d=O(r,s);e.addEventListener(S,d,{once:!0})}I(e,S,{bubbles:!1,cancelable:!0,detail:{originalEvent:a,contextmenu:!1,focusable:F(m(a))}})}})}return c.add(P(h,"focusin",E,!0)),c.add(y.addEventListener("focusin",E,!0)),()=>{clearTimeout(b),f.forEach(a=>a()),c.forEach(a=>a())}}function G(e,t){const{defer:n}=t,r=n?v:s=>s(),i=[];return i.push(r(()=>{const s=typeof e=="function"?e():e;i.push($(s,t))})),()=>{i.forEach(s=>s?.())}}function J(e,t){const n=r=>{r.key==="Escape"&&(r.isComposing||t?.(r))};return P(x(e),"keydown",n,{capture:!0})}var l={layers:[],branches:[],count(){return this.layers.length},pointerBlockingLayers(){return this.layers.filter(e=>e.pointerBlocking)},topMostPointerBlockingLayer(){return[...this.pointerBlockingLayers()].slice(-1)[0]},hasPointerBlockingLayer(){return this.pointerBlockingLayers().length>0},isBelowPointerBlockingLayer(e){const t=this.indexOf(e),n=this.topMostPointerBlockingLayer()?this.indexOf(this.topMostPointerBlockingLayer()?.node):-1;return t<n},isTopMost(e){return this.layers[this.count()-1]?.node===e},getNestedLayers(e){return Array.from(this.layers).slice(this.indexOf(e)+1)},isInNestedLayer(e,t){return this.getNestedLayers(e).some(n=>L(n.node,t))},isInBranch(e){return Array.from(this.branches).some(t=>L(t,e))},add(e){const t=this.layers.push(e);e.node.style.setProperty("--layer-index",`${t}`)},addBranch(e){this.branches.push(e)},remove(e){const t=this.indexOf(e);t<0||(t<this.count()-1&&this.getNestedLayers(e).forEach(r=>r.dismiss()),this.layers.splice(t,1),e.style.removeProperty("--layer-index"))},removeBranch(e){const t=this.branches.indexOf(e);t>=0&&this.branches.splice(t,1)},indexOf(e){return this.layers.findIndex(t=>t.node===e)},dismiss(e){this.layers[this.indexOf(e)]?.dismiss()},clear(){this.remove(this.layers[0].node)}},C;function T(){l.layers.forEach(({node:e})=>{e.style.pointerEvents=l.isBelowPointerBlockingLayer(e)?"none":"auto"})}function Q(e){e.style.pointerEvents=""}function Z(e,t){const n=x(e),r=[];if(l.hasPointerBlockingLayer()&&!n.body.hasAttribute("data-inert")&&(C=document.body.style.pointerEvents,queueMicrotask(()=>{n.body.style.pointerEvents="none",n.body.setAttribute("data-inert","")})),t){const i=K(t,s=>{r.push(z(s,{pointerEvents:"auto"}))});r.push(i)}return()=>{l.hasPointerBlockingLayer()||(queueMicrotask(()=>{n.body.style.pointerEvents=C,n.body.removeAttribute("data-inert"),n.body.style.length===0&&n.body.removeAttribute("style")}),r.forEach(i=>i()))}}function ee(e,t){if(!e){H("[@zag-js/dismissable] node is `null` or `undefined`");return}const{onDismiss:n,pointerBlocking:r,exclude:i,debug:s}=t,p={dismiss:n,node:e,pointerBlocking:r};l.add(p),T();function h(o){const c=m(o.detail.originalEvent);l.isBelowPointerBlockingLayer(e)||l.isInBranch(c)||(t.onPointerDownOutside?.(o),t.onInteractOutside?.(o),!o.defaultPrevented&&(s&&console.log("onPointerDownOutside:",o.detail.originalEvent),n?.()))}function k(o){const c=m(o.detail.originalEvent);l.isInBranch(c)||(t.onFocusOutside?.(o),t.onInteractOutside?.(o),!o.defaultPrevented&&(s&&console.log("onFocusOutside:",o.detail.originalEvent),n?.()))}function y(o){l.isTopMost(e)&&(t.onEscapeKeyDown?.(o),!o.defaultPrevented&&n&&(o.preventDefault(),n()))}function g(o){if(!e)return!1;const c=typeof i=="function"?i():i,b=Array.isArray(c)?c:[c],E=t.persistentElements?.map(a=>a()).filter(B);return E&&b.push(...E),b.some(a=>L(a,o))||l.isInNestedLayer(e,o)}const f=[r?Z(e,t.persistentElements):void 0,J(e,y),G(e,{exclude:g,onFocusOutside:k,onPointerDownOutside:h,defer:t.defer})];return()=>{l.remove(e),T(),Q(e),f.forEach(o=>o?.())}}function ie(e,t){const{defer:n}=t,r=n?v:s=>s(),i=[];return i.push(r(()=>{const s=q(e)?e():e;i.push(ee(s,t))})),()=>{i.forEach(s=>s?.())}}export{G as a,se as s,ie as t,re as u};
